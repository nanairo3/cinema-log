{"changed":true,"filter":false,"title":"cinema_pages_controller.rb","tooltip":"/app/controllers/cinema_pages_controller.rb","value":"# frozen_string_literal: true\n\nclass CinemaPagesController < ApplicationController\n  \n  def home\n    response = Movie.now_playing(1)\n    @movies = []\n    response.each do |m|\n      @movies << m unless m['poster_path'].blank?\n    end\n    if @movies.count < 12\n      response = Movie.now_playing(2)\n      response.each do |m|\n        @movies << m unless m['poster_path'].blank?\n      end\n    end\n  end\n\n  def show\n    @movie = Movie.details(params[:id])\n    @cast_range = if @movie['credits']['cast'].count > 6\n                    6\n                  else\n                    @movie['credits']['cast'].count\n                  end\n    @trailers = Movie.trailers(params[:id])\n\n    @directors = {}\n    @writers = {}\n    @story = {}\n    @screenplay = {}\n    @novel = {}\n    @music = {}\n    @movie['credits']['crew'].each do |crew|\n      @directors[crew['name']] = crew['id'] if crew['job'] == 'Director'\n      @writers[crew['name']] = crew['id'] if crew['job'] == 'Writer'\n      @story[crew['name']] = crew['id'] if crew['job'] == 'Story'\n      @screenplay[crew['name']] = crew['id'] if crew['job'] == 'Screenplay'\n      @novel[crew['name']] = crew['id'] if crew['job'] == 'Novel'\n      @music[crew['name']] = crew['id'] if crew['job'] == 'Original Music Composer'\n    end\n    @directors_count = @directors.size\n    @writers_count = @writers.size\n    @story_count = @story.size\n    @screenplay_count = @screenplay.size\n    @novel_count = @novel.size\n    @music_count = @music.size\n\n  end\nend\n","undoManager":{"mark":18,"position":20,"stack":[[{"start":{"row":3,"column":2},"end":{"row":4,"column":0},"action":"remove","lines":["include MoviesHelper",""],"id":2}],[{"start":{"row":11,"column":35},"end":{"row":11,"column":36},"action":"remove","lines":["2"],"id":3}],[{"start":{"row":11,"column":35},"end":{"row":11,"column":36},"action":"insert","lines":["1"],"id":4}],[{"start":{"row":11,"column":35},"end":{"row":11,"column":36},"action":"remove","lines":["1"],"id":5}],[{"start":{"row":11,"column":35},"end":{"row":11,"column":36},"action":"insert","lines":["2"],"id":6}],[{"start":{"row":5,"column":32},"end":{"row":5,"column":34},"action":"insert","lines":["()"],"id":7}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"insert","lines":["2"],"id":8}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"remove","lines":["2"],"id":9}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"insert","lines":["1"],"id":10}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"remove","lines":["1"],"id":11}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"insert","lines":["3"],"id":12}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"remove","lines":["3"],"id":13}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"insert","lines":["2"],"id":14}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"remove","lines":["2"],"id":15}],[{"start":{"row":5,"column":33},"end":{"row":5,"column":34},"action":"insert","lines":["1"],"id":16}],[{"start":{"row":5,"column":34},"end":{"row":5,"column":35},"action":"insert","lines":[","],"id":17},{"start":{"row":5,"column":35},"end":{"row":5,"column":36},"action":"insert","lines":["2"]}],[{"start":{"row":5,"column":35},"end":{"row":5,"column":36},"action":"remove","lines":["2"],"id":18},{"start":{"row":5,"column":34},"end":{"row":5,"column":35},"action":"remove","lines":[","]}],[{"start":{"row":8,"column":29},"end":{"row":8,"column":42},"action":"remove","lines":["backdrop_path"],"id":34},{"start":{"row":8,"column":29},"end":{"row":8,"column":40},"action":"insert","lines":["poster_path"]}],[{"start":{"row":13,"column":31},"end":{"row":13,"column":44},"action":"remove","lines":["backdrop_path"],"id":35},{"start":{"row":13,"column":31},"end":{"row":13,"column":42},"action":"insert","lines":["poster_path"]}],[{"start":{"row":56,"column":2},"end":{"row":67,"column":5},"action":"remove","lines":["def show_person","    @person = Movie.person_details(params[:id])","","    @movie_credits = []","    if @person['known_for_department'] == 'Acting'","      @person['movie_credits']['cast'].each do |movie|","        next if movie['character'].blank? || movie['release_date'].blank?","","        @movie_credits << movie","      end","    end","  end"],"id":36},{"start":{"row":56,"column":0},"end":{"row":56,"column":2},"action":"remove","lines":["  "]},{"start":{"row":55,"column":0},"end":{"row":56,"column":0},"action":"remove","lines":["",""]},{"start":{"row":54,"column":5},"end":{"row":55,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":48,"column":4},"end":{"row":53,"column":9},"action":"remove","lines":["# if Movie.exists?(@movie[\"id\"])","    #   # find movie object from database","    #   @movie_db = Movie.find(@movie[\"id\"])","    #   # paginate all of the movie's comments","    #   @comments = @movie_db.comments.paginate(page: params[:page])","    # end"],"id":37},{"start":{"row":48,"column":2},"end":{"row":48,"column":4},"action":"remove","lines":["  "]},{"start":{"row":48,"column":0},"end":{"row":48,"column":2},"action":"remove","lines":["  "]},{"start":{"row":47,"column":0},"end":{"row":48,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":120,"scrollleft":0,"selection":{"start":{"row":26,"column":0},"end":{"row":26,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":3,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1568362503728}